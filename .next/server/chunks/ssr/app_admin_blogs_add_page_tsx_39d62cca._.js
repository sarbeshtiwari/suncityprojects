module.exports=[52821,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);function e({initialData:a,isEditMode:f=!1,blogSlug:g}={}){var h;let i=(0,d.useRouter)(),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(new Set),[n,o]=(0,c.useState)({metaTitle:a?.metaTitle||"",metaKeywords:a?.metaKeywords||"",metaDescription:a?.metaDescription||"",otherMetaTags:a?.otherMetaTags||"",schemaScript:a?.schemaScript||"",title:a?.title||"",slug:a?.slug||"",content:a?.content||"",excerpt:a?.excerpt||"",image:a?.image||"",altText:a?.altText||"",author:a?.author||"Suncity Projects",publishedDate:(h=a?.publishedDate)?"string"==typeof h?/^\d{4}-\d{2}-\d{2}$/.test(h)?h:h.split("T")[0]:new Date(h).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],isPublished:a?.isPublished===void 0||a.isPublished,isActive:a?.isActive===void 0||a.isActive,tags:a?.tags||[],category:a?.category||"real-estate"}),[p,q]=(0,c.useState)(""),r=a=>{let{name:b,value:c,type:d}=a.target;o(e=>{let f={...e,[b]:"checkbox"===d?a.target.checked:c};return"title"===b&&c&&(f.slug=c.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()),f})},s=()=>{let a=p.trim();a&&!n.tags.includes(a)&&(o(b=>({...b,tags:[...b.tags,a]})),q(""))},t=async(a,b)=>{let c=`${b}-${Date.now()}`;m(a=>new Set(a).add(c));try{let b=new FormData;b.append("file",a),b.append("folder","blogs");let c=await fetch("/api/upload",{method:"POST",body:b});if(c.ok)return(await c.json()).url;throw Error("Upload failed")}catch(a){return console.error("Upload error:",a),alert("Failed to upload file"),null}finally{m(a=>{let b=new Set(a);return b.delete(c),b})}},u=async(a,b)=>{let c=a.target.files?.[0];if(!c)return;let d=await t(c,b);d&&o(a=>({...a,[b]:d}))},v=async a=>{a.preventDefault(),k(!0);try{let a=["title","slug","content","excerpt","altText"];f&&n.image||a.push("image");let b=a.filter(a=>!n[a]);if(b.length>0){alert(`Please fill in all required fields: ${b.join(", ")}`),k(!1);return}let c=f?`/api/blogs/${g}`:"/api/blogs",d=await fetch(c,{method:f?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("adminToken")}`},body:JSON.stringify(n)}),e=await d.json();if(e.success)alert(f?"Blog updated successfully!":"Blog created successfully!"),i.push("/admin/blogs");else{let a=e.details?`${e.error}: ${Array.isArray(e.details)?e.details.join(", "):e.details}`:e.error;alert(`Failed to ${f?"update":"create"} blog: `+a)}}catch(a){console.error(`Error ${f?"updating":"creating"} blog:`,a),alert(`Error ${f?"updating":"creating"} blog: `+(a instanceof Error?a.message:"Unknown error"))}finally{k(!1)}};return(0,b.jsxs)("div",{className:"w-100",children:[(0,b.jsxs)("div",{className:"d-flex align-items-center justify-content-between mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"h2 fw-bold text-dark mb-1",children:f?"Edit Blog":"Add New Blog"}),(0,b.jsx)("p",{className:"text-muted mb-0",children:f?"Update the blog post":"Create a new blog post"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>i.back(),className:"btn btn-outline-secondary d-inline-flex align-items-center px-3 py-2",children:"← Back to Blogs"})]}),(0,b.jsxs)("form",{onSubmit:v,className:"w-100",children:[(0,b.jsx)("div",{className:"card shadow-sm mb-4",children:(0,b.jsxs)("div",{className:"card-body p-4",children:[(0,b.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"SEO Details"}),(0,b.jsxs)("div",{className:"row g-3",children:[(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Title"}),(0,b.jsx)("input",{type:"text",name:"metaTitle",value:n.metaTitle,onChange:r,className:"form-control"})]}),(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Keywords"}),(0,b.jsx)("input",{type:"text",name:"metaKeywords",value:n.metaKeywords,onChange:r,className:"form-control"})]}),(0,b.jsxs)("div",{className:"col-12",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Description"}),(0,b.jsx)("textarea",{name:"metaDescription",value:n.metaDescription,onChange:r,className:"form-control",rows:3})]})]})]})}),(0,b.jsx)("div",{className:"card shadow-sm mb-4",children:(0,b.jsxs)("div",{className:"card-body p-4",children:[(0,b.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Blog Information"}),(0,b.jsxs)("div",{className:"row g-3",children:[(0,b.jsxs)("div",{className:"col-12 col-lg-8",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Title"}),(0,b.jsx)("input",{type:"text",name:"title",value:n.title,onChange:r,required:!0,className:"form-control"})]}),(0,b.jsxs)("div",{className:"col-12 col-lg-4",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Slug (URL-friendly name)"}),(0,b.jsx)("input",{type:"text",name:"slug",value:n.slug,onChange:r,placeholder:"Will be auto-generated from title",className:"form-control"}),(0,b.jsx)("p",{className:"form-text small text-muted",children:"Leave empty to auto-generate from title"})]}),(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Author"}),(0,b.jsx)("input",{type:"text",name:"author",value:n.author,onChange:r,required:!0,className:"form-control"})]}),(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Category"}),(0,b.jsxs)("select",{name:"category",value:n.category,onChange:r,required:!0,className:"form-control form-select",children:[(0,b.jsx)("option",{value:"real-estate",children:"Real Estate"}),(0,b.jsx)("option",{value:"investment",children:"Investment"}),(0,b.jsx)("option",{value:"lifestyle",children:"Lifestyle"}),(0,b.jsx)("option",{value:"legal",children:"Legal"}),(0,b.jsx)("option",{value:"tips",children:"Tips"}),(0,b.jsx)("option",{value:"news",children:"News"})]})]}),(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Published Date"}),(0,b.jsx)("input",{type:"date",name:"publishedDate",value:n.publishedDate,onChange:r,required:!0,className:"form-control"})]}),(0,b.jsxs)("div",{className:"col-12 col-lg-6 d-flex align-items-center",children:[(0,b.jsxs)("div",{className:"form-check me-3",children:[(0,b.jsx)("input",{type:"checkbox",name:"isPublished",checked:n.isPublished,onChange:r,className:"form-check-input",id:"isPublished"}),(0,b.jsx)("label",{className:"form-check-label small text-muted",htmlFor:"isPublished",children:"Published"})]}),(0,b.jsxs)("div",{className:"form-check",children:[(0,b.jsx)("input",{type:"checkbox",name:"isActive",checked:n.isActive,onChange:r,className:"form-check-input",id:"isActive"}),(0,b.jsx)("label",{className:"form-check-label small text-muted",htmlFor:"isActive",children:"Active"})]})]})]})]})}),(0,b.jsx)("div",{className:"card shadow-sm mb-4",children:(0,b.jsxs)("div",{className:"card-body p-4",children:[(0,b.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Content"}),(0,b.jsxs)("div",{className:"row g-3",children:[(0,b.jsxs)("div",{className:"col-12",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Excerpt (Short Description)"}),(0,b.jsx)("textarea",{name:"excerpt",value:n.excerpt,onChange:r,required:!0,rows:3,className:"form-control",placeholder:"Brief description of the blog post..."})]}),(0,b.jsxs)("div",{className:"col-12",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Content"}),(0,b.jsx)("textarea",{name:"content",value:n.content,onChange:r,required:!0,rows:10,className:"form-control",placeholder:"Write your blog content here..."}),(0,b.jsx)("p",{className:"form-text small text-muted",children:"You can use HTML tags for formatting"})]})]})]})}),(0,b.jsx)("div",{className:"card shadow-sm mb-4",children:(0,b.jsxs)("div",{className:"card-body p-4",children:[(0,b.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Featured Image"}),(0,b.jsxs)("div",{className:"row g-3",children:[(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Blog Image"}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>u(a,"image"),required:!f||!n.image,className:"form-control"}),f&&n.image&&(0,b.jsx)("p",{className:"form-text small text-muted mt-1",children:"Current image is uploaded. Leave empty to keep existing image."}),n.image&&(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)("img",{src:n.image,alt:"Blog Image Preview",className:"rounded",style:{height:"10rem",width:"15rem",objectFit:"cover"}})})]}),(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Alt Text"}),(0,b.jsx)("input",{type:"text",name:"altText",value:n.altText,onChange:r,required:!0,className:"form-control"})]})]})]})}),(0,b.jsx)("div",{className:"card shadow-sm mb-4",children:(0,b.jsxs)("div",{className:"card-body p-4",children:[(0,b.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Tags"}),(0,b.jsx)("div",{className:"row g-3",children:(0,b.jsxs)("div",{className:"col-12",children:[n.tags.length>0&&(0,b.jsx)("div",{className:"mb-3",children:(0,b.jsx)("div",{className:"d-flex flex-wrap gap-2",children:n.tags.map((a,c)=>(0,b.jsxs)("span",{className:"badge bg-primary d-inline-flex align-items-center gap-1",style:{fontSize:"0.875rem"},children:[a,(0,b.jsx)("button",{type:"button",onClick:()=>{o(b=>({...b,tags:b.tags.filter(b=>b!==a)}))},className:"btn btn-sm p-0 ms-1",style:{fontSize:"0.6rem",background:"none",border:"none",color:"white",lineHeight:"1"},"aria-label":`Remove ${a} tag`,children:"×"})]},c))})}),(0,b.jsx)("div",{className:"input-group",children:(0,b.jsx)("input",{type:"text",value:p,onChange:a=>{q(a.target.value)},onKeyDown:a=>{"Enter"===a.key?(a.preventDefault(),s()):","===a.key&&(a.preventDefault(),s())},className:"form-control",placeholder:"Type a tag and press Enter or comma to add"})}),(0,b.jsx)("p",{className:"form-text small text-muted",children:"Type a tag and press Enter or comma to add it. Click the × on a tag to remove it."})]})})]})}),(0,b.jsxs)("div",{className:"d-flex justify-content-end gap-3",children:[(0,b.jsx)("button",{type:"button",onClick:()=>i.back(),className:"btn btn-outline-secondary px-4 py-2",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:j,className:"btn btn-primary px-4 py-2",children:j?f?"Updating...":"Creating...":f?"Update Blog":"Create Blog"})]})]})]})}a.s(["default",()=>e])}];

//# sourceMappingURL=app_admin_blogs_add_page_tsx_39d62cca._.js.map