{"version":3,"sources":["../../../../app/admin/blogs/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\n\r\ninterface Blog {\r\n  _id: string;\r\n  title: string;\r\n  slug: string;\r\n  excerpt: string;\r\n  author: string;\r\n  publishedDate: string;\r\n  isPublished: boolean;\r\n  isActive: boolean;\r\n  category: string;\r\n  createdAt: string;\r\n}\r\n\r\nexport default function BlogsPage() {\r\n  const [blogs, setBlogs] = useState<Blog[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    fetchBlogs();\r\n  }, []);\r\n\r\n  const fetchBlogs = async () => {\r\n    try {\r\n      const token = localStorage.getItem('adminToken');\r\n      const response = await fetch('/api/admin/blogs', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setBlogs(data.data);\r\n      } else {\r\n        setError('Failed to fetch blogs');\r\n      }\r\n    } catch (err) {\r\n      setError('Error fetching blogs');\r\n      console.error('Error:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (slug: string) => {\r\n    if (!window.confirm('Are you sure you want to delete this blog?')) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const token = localStorage.getItem('adminToken');\r\n      const response = await fetch(`/api/blogs/${slug}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        setBlogs(blogs.filter(blog => blog.slug !== slug));\r\n      } else {\r\n        alert('Failed to delete blog');\r\n      }\r\n    } catch (err) {\r\n      console.error('Error deleting blog:', err);\r\n      alert('Error deleting blog');\r\n    }\r\n  };\r\n\r\n  const handleStatusUpdate = async (id: string, currentStatus: boolean) => {\r\n    try {\r\n      const response = await fetch(`/api/blogs/updateStatus`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          _id: id,\r\n          isActive: !currentStatus,\r\n        }),\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      if (result.success) {\r\n        setBlogs(prevProjects =>\r\n          prevProjects.map(proj =>\r\n            proj._id === id ? { ...proj, isActive: !currentStatus, isPublished: !currentStatus } : proj\r\n          )\r\n        );\r\n      } else {\r\n        alert(result.message || \"Failed to update status\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error updating project status:\", err);\r\n      alert(\"Error updating project status\");\r\n    } \r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString('en-US', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric'\r\n    });\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"d-flex align-items-center justify-content-center\" style={{minHeight: '50vh'}}>\r\n        <div className=\"text-center\">\r\n          <div className=\"spinner mx-auto mb-4\" style={{width: '3rem', height: '3rem'}}></div>\r\n          <p className=\"text-muted\">Loading blogs...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"mb-5\">\r\n      <div className=\"d-flex justify-content-between align-items-center mb-4\">\r\n        <div>\r\n          <h1 className=\"h2 fw-bold text-dark mb-1\">Blogs</h1>\r\n          <p className=\"text-muted mb-0\">Manage your blog posts</p>\r\n        </div>\r\n        <Link\r\n          href=\"/admin/blogs/add\"\r\n          className=\"btn btn-primary\"\r\n        >\r\n          Add New Blog\r\n        </Link>\r\n      </div>\r\n\r\n      {error && (\r\n        <div className=\"alert alert-danger\" role=\"alert\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"card shadow-sm\">\r\n        <div className=\"table-responsive\">\r\n          <table className=\"table table-hover align-middle mb-0\">\r\n            <thead className=\"table-light\">\r\n              <tr>\r\n                <th scope=\"col\" className=\"text-uppercase small text-muted\">Title</th>\r\n                <th scope=\"col\" className=\"text-uppercase small text-muted\">Author</th>\r\n                <th scope=\"col\" className=\"text-uppercase small text-muted\">Category</th>\r\n                <th scope=\"col\" className=\"text-uppercase small text-muted\">Published</th>\r\n                <th scope=\"col\" className=\"text-uppercase small text-muted\">Status</th>\r\n                <th scope=\"col\" className=\"text-uppercase small text-muted\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {blogs.map((blog) => (\r\n                <tr key={blog._id}>\r\n                  <td>\r\n                    <div className=\"d-flex flex-column\">\r\n                      <span className=\"fw-medium text-dark\">{blog.title}</span>\r\n                      <small className=\"text-muted\">{blog.excerpt.substring(0, 60)}...</small>\r\n                    </div>\r\n                  </td>\r\n                  <td>\r\n                    <span className=\"text-muted\">{blog.author}</span>\r\n                  </td>\r\n                  <td>\r\n                    <span className={`badge bg-secondary text-capitalize`}>\r\n                      {blog.category.replace('-', ' ')}\r\n                    </span>\r\n                  </td>\r\n                  <td>\r\n                    <span className=\"text-muted\">{formatDate(blog.publishedDate)}</span>\r\n                  </td>\r\n                  <td>\r\n                    <button\r\n                      className={`badge rounded-pill border-0 px-3 py-2 ${\r\n                        blog.isPublished ? \"bg-success\" : \"bg-danger\"\r\n                      }`}\r\n                      style={{ cursor: \"pointer\" }}\r\n                      onClick={() => handleStatusUpdate(blog._id, blog.isPublished)}\r\n                    >\r\n                      <span\r\n                        className={`badge rounded-pill ${\r\n                          blog.isPublished\r\n                            ? \"bg-success\"\r\n                            : \"bg-danger\"\r\n                        }`}\r\n                      >\r\n                        {blog.isPublished ? \"Published\" : \"Draft\"}\r\n                      </span>\r\n                    </button>\r\n                  </td>                 \r\n                  <td>\r\n                    <div className=\"d-flex gap-2\">\r\n                      <Link\r\n                        href={`/admin/blogs/edit/${blog.slug}`}\r\n                        className=\"btn btn-sm btn-outline-primary\"\r\n                      >\r\n                        Edit\r\n                      </Link>\r\n                      <button\r\n                        onClick={(e) => {\r\n    e.stopPropagation(); // stop parent clicks\r\n    handleDelete(blog.slug);\r\n  }}\r\n                        className=\"btn btn-sm btn-outline-danger\"\r\n                      >\r\n                        Delete\r\n                      </button>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {blogs.length === 0 && (\r\n        <div className=\"text-center py-5\">\r\n          <div className=\"text-muted mb-3\">\r\n            <i className=\"fas fa-newspaper\" style={{fontSize: '3rem'}}></i>\r\n          </div>\r\n          <h4 className=\"text-muted\">No blogs found</h4>\r\n          <p className=\"text-muted\">Get started by creating your first blog post.</p>\r\n          <Link href=\"/admin/blogs/add\" className=\"btn btn-primary\">\r\n            Add New Blog\r\n          </Link>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}