module.exports=[23558,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);function e({initialData:a,isEditMode:f=!1,eventSlug:g}={}){let h=(0,d.useRouter)(),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(new Set),[m,n]=(0,c.useState)({title:a?.title||"",slug:a?.slug||"",description:a?.description||"",galleryImages:a?.galleryImages||[],metaTitle:a?.metaTitle||"",metaDescription:a?.metaDescription||"",metaKeywords:a?.metaKeywords||"",otherMetaTags:a?.otherMetaTags||"",schemaScript:a?.schemaScript||"",isActive:a?.isActive===void 0||a.isActive,isPublished:a?.isPublished===void 0||a.isPublished}),o=a=>{let{name:b,value:c,type:d}=a.target;n(e=>{let f={...e,[b]:"checkbox"===d?a.target.checked:c};return"title"===b&&c&&(f.slug=c.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()),f})},p=async(a,b)=>{let c=`${b}-${Date.now()}`;l(a=>new Set(a).add(c));try{let b=new FormData;b.append("file",a);let c=await fetch("/api/upload",{method:"POST",body:b});if(c.ok)return(await c.json()).url;throw Error("Upload failed")}catch(a){return console.error("Upload error:",a),alert("Failed to upload file"),null}finally{l(a=>{let b=new Set(a);return b.delete(c),b})}},q=async(a,b,c)=>{let d=a.target.files?.[0];if(!d)return;let e=await p(d,`gallery-${b}-${c}`);e&&n(a=>({...a,galleryImages:a.galleryImages.map((a,d)=>d===b?{...a,[c]:e}:a)}))},r=async a=>{a.preventDefault(),j(!0);try{let a=["title","slug","description"].filter(a=>!m[a]);if(a.length>0){alert(`Please fill in all required fields: ${a.join(", ")}`),j(!1);return}if(!m.galleryImages.some(a=>a.thumbnail&&a.original)){alert("Please add at least one gallery image with both thumbnail and original"),j(!1);return}let b=f?`/api/events/${g}`:"/api/events",c=f?"PUT":"POST",d=await fetch(b,{method:c,headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("adminToken")}`},body:JSON.stringify(m)}),e=await d.json();if(e.success)alert(f?"Event updated successfully!":"Event created successfully!"),h.push("/admin/events");else{let a=e.details?`${e.error}: ${Array.isArray(e.details)?e.details.join(", "):e.details}`:e.error;alert(`Failed to ${f?"update":"create"} event: `+a)}}catch(a){console.error(`Error ${f?"updating":"creating"} event:`,a),alert(`Error ${f?"updating":"creating"} event: `+(a instanceof Error?a.message:"Unknown error"))}finally{j(!1)}};return(0,b.jsxs)("div",{className:"w-100",children:[(0,b.jsxs)("div",{className:"d-flex align-items-center justify-content-between mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"h2 fw-bold text-dark mb-1",children:f?"Edit Event":"Add New Event"}),(0,b.jsx)("p",{className:"text-muted mb-0",children:f?"Update the event details":"Create a new event with gallery images"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>h.back(),className:"btn btn-outline-secondary d-inline-flex align-items-center px-3 py-2",children:"â† Back to Events"})]}),(0,b.jsxs)("form",{onSubmit:r,className:"w-100",children:[(0,b.jsx)("div",{className:"card shadow-sm mb-4",children:(0,b.jsxs)("div",{className:"card-body p-4",children:[(0,b.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"SEO Details"}),(0,b.jsxs)("div",{className:"row g-3",children:[(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Title"}),(0,b.jsx)("input",{type:"text",name:"metaTitle",value:m.metaTitle,onChange:o,className:"form-control"})]}),(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Keywords"}),(0,b.jsx)("input",{type:"text",name:"metaKeywords",value:m.metaKeywords,onChange:o,className:"form-control"})]}),(0,b.jsxs)("div",{className:"col-12",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Description"}),(0,b.jsx)("textarea",{name:"metaDescription",value:m.metaDescription,onChange:o,className:"form-control",rows:3})]})]})]})}),(0,b.jsx)("div",{className:"card shadow-sm mb-4",children:(0,b.jsxs)("div",{className:"card-body p-4",children:[(0,b.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Event Information"}),(0,b.jsxs)("div",{className:"row g-3",children:[(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Event Title"}),(0,b.jsx)("input",{type:"text",name:"title",value:m.title,onChange:o,required:!0,className:"form-control"})]}),(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Slug (URL-friendly name)"}),(0,b.jsx)("input",{type:"text",name:"slug",value:m.slug,onChange:o,placeholder:"Will be auto-generated from title",className:"form-control"})]}),(0,b.jsxs)("div",{className:"col-12",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Event Description"}),(0,b.jsx)("textarea",{name:"description",value:m.description,onChange:o,required:!0,rows:5,className:"form-control"})]})]})]})}),(0,b.jsx)("div",{className:"card shadow-sm mb-4",children:(0,b.jsxs)("div",{className:"card-body p-4",children:[(0,b.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Gallery Images"}),(0,b.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,b.jsx)("h3",{className:"h6 fw-medium text-dark mb-0",children:"Event Gallery"}),(0,b.jsx)("button",{type:"button",onClick:()=>{n(a=>({...a,galleryImages:[...a.galleryImages,{original:"",thumbnail:"",altText:""}]}))},className:"btn btn-primary btn-sm",children:"Add Image"})]}),m.galleryImages.map((a,c)=>(0,b.jsxs)("div",{className:"border rounded p-3 mb-3",children:[(0,b.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,b.jsxs)("h4",{className:"fw-medium text-dark mb-0",children:["Image ",c+1]}),(0,b.jsx)("button",{type:"button",onClick:()=>{n(a=>({...a,galleryImages:a.galleryImages.filter((a,b)=>b!==c)}))},className:"btn btn-sm btn-outline-danger",children:"Remove"})]}),(0,b.jsxs)("div",{className:"row g-3",children:[(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Thumbnail Image"}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>q(a,c,"thumbnail"),required:!f||!a.thumbnail,className:"form-control"}),f&&a.thumbnail&&(0,b.jsx)("p",{className:"form-text small text-muted mt-1",children:"Current thumbnail is uploaded. Leave empty to keep existing thumbnail."}),a.thumbnail&&(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)("img",{src:a.thumbnail,alt:"Thumbnail Preview",className:"rounded",style:{height:"5rem",width:"8rem",objectFit:"cover"}})})]}),(0,b.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Original Image"}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>q(a,c,"original"),required:!f||!a.original,className:"form-control"}),f&&a.original&&(0,b.jsx)("p",{className:"form-text small text-muted mt-1",children:"Current original image is uploaded. Leave empty to keep existing original image."}),a.original&&(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)("img",{src:a.original,alt:"Original Preview",className:"rounded",style:{height:"5rem",width:"8rem",objectFit:"cover"}})})]}),(0,b.jsxs)("div",{className:"col-12",children:[(0,b.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Alt Text"}),(0,b.jsx)("input",{type:"text",value:a.altText,onChange:a=>{var b;return b=a.target.value,void n(a=>({...a,galleryImages:a.galleryImages.map((a,d)=>d===c?{...a,altText:b}:a)}))},className:"form-control"})]})]})]},c))]})}),(0,b.jsx)("div",{className:"card shadow-sm mb-4",children:(0,b.jsxs)("div",{className:"card-body p-4",children:[(0,b.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Status"}),(0,b.jsxs)("div",{className:"row g-3",children:[(0,b.jsx)("div",{className:"col-12 col-lg-6",children:(0,b.jsxs)("div",{className:"form-check",children:[(0,b.jsx)("input",{type:"checkbox",name:"isActive",checked:m.isActive,onChange:o,className:"form-check-input",id:"isActive"}),(0,b.jsx)("label",{className:"form-check-label",htmlFor:"isActive",children:"Active"})]})}),(0,b.jsx)("div",{className:"col-12 col-lg-6",children:(0,b.jsxs)("div",{className:"form-check",children:[(0,b.jsx)("input",{type:"checkbox",name:"isPublished",checked:m.isPublished,onChange:o,className:"form-check-input",id:"isPublished"}),(0,b.jsx)("label",{className:"form-check-label",htmlFor:"isPublished",children:"Published"})]})})]})]})}),(0,b.jsxs)("div",{className:"d-flex justify-content-end gap-3",children:[(0,b.jsx)("button",{type:"button",onClick:()=>h.back(),className:"btn btn-outline-secondary px-4 py-2",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:i,className:"btn btn-primary px-4 py-2",children:i?f?"Updating...":"Creating...":f?"Update Event":"Create Event"})]})]})]})}a.s(["default",()=>e])}];

//# sourceMappingURL=app_admin_events_add_page_tsx_a3a9f77f._.js.map