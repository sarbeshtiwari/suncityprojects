(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,1759,e=>{"use strict";var l=e.i(43476),a=e.i(71645),t=e.i(18566);function s({initialData:e,isEditMode:r=!1,blogSlug:i}={}){var c;let o=(0,t.useRouter)(),[n,m]=(0,a.useState)(!1),[d,h]=(0,a.useState)(new Set),[u,x]=(0,a.useState)({metaTitle:e?.metaTitle||"",metaKeywords:e?.metaKeywords||"",metaDescription:e?.metaDescription||"",otherMetaTags:e?.otherMetaTags||"",schemaScript:e?.schemaScript||"",title:e?.title||"",slug:e?.slug||"",content:e?.content||"",excerpt:e?.excerpt||"",image:e?.image||"",altText:e?.altText||"",author:e?.author||"Suncity Projects",publishedDate:(c=e?.publishedDate)?"string"==typeof c?/^\d{4}-\d{2}-\d{2}$/.test(c)?c:c.split("T")[0]:new Date(c).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],isPublished:e?.isPublished===void 0||e.isPublished,isActive:e?.isActive===void 0||e.isActive,tags:e?.tags||[],category:e?.category||"real-estate"}),[g,p]=(0,a.useState)(""),b=e=>{let{name:l,value:a,type:t}=e.target;x(s=>{let r={...s,[l]:"checkbox"===t?e.target.checked:a};return"title"===l&&a&&(r.slug=a.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()),r})},f=()=>{let e=g.trim();e&&!u.tags.includes(e)&&(x(l=>({...l,tags:[...l.tags,e]})),p(""))},j=async(e,l)=>{let a=`${l}-${Date.now()}`;h(e=>new Set(e).add(a));try{let l=new FormData;l.append("file",e),l.append("folder","blogs");let a=await fetch("/api/upload",{method:"POST",body:l});if(a.ok)return(await a.json()).url;throw Error("Upload failed")}catch(e){return console.error("Upload error:",e),alert("Failed to upload file"),null}finally{h(e=>{let l=new Set(e);return l.delete(a),l})}},N=async(e,l)=>{let a=e.target.files?.[0];if(!a)return;let t=await j(a,l);t&&x(e=>({...e,[l]:t}))},v=async e=>{e.preventDefault(),m(!0);try{let e=["title","slug","content","excerpt","altText"];r&&u.image||e.push("image");let l=e.filter(e=>!u[e]);if(l.length>0){alert(`Please fill in all required fields: ${l.join(", ")}`),m(!1);return}let a=r?`/api/blogs/${i}`:"/api/blogs",t=await fetch(a,{method:r?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("adminToken")}`},body:JSON.stringify(u)}),s=await t.json();if(s.success)alert(r?"Blog updated successfully!":"Blog created successfully!"),o.push("/admin/blogs");else{let e=s.details?`${s.error}: ${Array.isArray(s.details)?s.details.join(", "):s.details}`:s.error;alert(`Failed to ${r?"update":"create"} blog: `+e)}}catch(e){console.error(`Error ${r?"updating":"creating"} blog:`,e),alert(`Error ${r?"updating":"creating"} blog: `+(e instanceof Error?e.message:"Unknown error"))}finally{m(!1)}};return(0,l.jsxs)("div",{className:"w-100",children:[(0,l.jsxs)("div",{className:"d-flex align-items-center justify-content-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"h2 fw-bold text-dark mb-1",children:r?"Edit Blog":"Add New Blog"}),(0,l.jsx)("p",{className:"text-muted mb-0",children:r?"Update the blog post":"Create a new blog post"})]}),(0,l.jsx)("button",{type:"button",onClick:()=>o.back(),className:"btn btn-outline-secondary d-inline-flex align-items-center px-3 py-2",children:"← Back to Blogs"})]}),(0,l.jsxs)("form",{onSubmit:v,className:"w-100",children:[(0,l.jsx)("div",{className:"card shadow-sm mb-4",children:(0,l.jsxs)("div",{className:"card-body p-4",children:[(0,l.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"SEO Details"}),(0,l.jsxs)("div",{className:"row g-3",children:[(0,l.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Title"}),(0,l.jsx)("input",{type:"text",name:"metaTitle",value:u.metaTitle,onChange:b,className:"form-control"})]}),(0,l.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Keywords"}),(0,l.jsx)("input",{type:"text",name:"metaKeywords",value:u.metaKeywords,onChange:b,className:"form-control"})]}),(0,l.jsxs)("div",{className:"col-12",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Description"}),(0,l.jsx)("textarea",{name:"metaDescription",value:u.metaDescription,onChange:b,className:"form-control",rows:3})]})]})]})}),(0,l.jsx)("div",{className:"card shadow-sm mb-4",children:(0,l.jsxs)("div",{className:"card-body p-4",children:[(0,l.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Blog Information"}),(0,l.jsxs)("div",{className:"row g-3",children:[(0,l.jsxs)("div",{className:"col-12 col-lg-8",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Title"}),(0,l.jsx)("input",{type:"text",name:"title",value:u.title,onChange:b,required:!0,className:"form-control"})]}),(0,l.jsxs)("div",{className:"col-12 col-lg-4",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Slug (URL-friendly name)"}),(0,l.jsx)("input",{type:"text",name:"slug",value:u.slug,onChange:b,placeholder:"Will be auto-generated from title",className:"form-control"}),(0,l.jsx)("p",{className:"form-text small text-muted",children:"Leave empty to auto-generate from title"})]}),(0,l.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Author"}),(0,l.jsx)("input",{type:"text",name:"author",value:u.author,onChange:b,required:!0,className:"form-control"})]}),(0,l.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Category"}),(0,l.jsxs)("select",{name:"category",value:u.category,onChange:b,required:!0,className:"form-control form-select",children:[(0,l.jsx)("option",{value:"real-estate",children:"Real Estate"}),(0,l.jsx)("option",{value:"investment",children:"Investment"}),(0,l.jsx)("option",{value:"lifestyle",children:"Lifestyle"}),(0,l.jsx)("option",{value:"legal",children:"Legal"}),(0,l.jsx)("option",{value:"tips",children:"Tips"}),(0,l.jsx)("option",{value:"news",children:"News"})]})]}),(0,l.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Published Date"}),(0,l.jsx)("input",{type:"date",name:"publishedDate",value:u.publishedDate,onChange:b,required:!0,className:"form-control"})]}),(0,l.jsxs)("div",{className:"col-12 col-lg-6 d-flex align-items-center",children:[(0,l.jsxs)("div",{className:"form-check me-3",children:[(0,l.jsx)("input",{type:"checkbox",name:"isPublished",checked:u.isPublished,onChange:b,className:"form-check-input",id:"isPublished"}),(0,l.jsx)("label",{className:"form-check-label small text-muted",htmlFor:"isPublished",children:"Published"})]}),(0,l.jsxs)("div",{className:"form-check",children:[(0,l.jsx)("input",{type:"checkbox",name:"isActive",checked:u.isActive,onChange:b,className:"form-check-input",id:"isActive"}),(0,l.jsx)("label",{className:"form-check-label small text-muted",htmlFor:"isActive",children:"Active"})]})]})]})]})}),(0,l.jsx)("div",{className:"card shadow-sm mb-4",children:(0,l.jsxs)("div",{className:"card-body p-4",children:[(0,l.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Content"}),(0,l.jsxs)("div",{className:"row g-3",children:[(0,l.jsxs)("div",{className:"col-12",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Excerpt (Short Description)"}),(0,l.jsx)("textarea",{name:"excerpt",value:u.excerpt,onChange:b,required:!0,rows:3,className:"form-control",placeholder:"Brief description of the blog post..."})]}),(0,l.jsxs)("div",{className:"col-12",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Content"}),(0,l.jsx)("textarea",{name:"content",value:u.content,onChange:b,required:!0,rows:10,className:"form-control",placeholder:"Write your blog content here..."}),(0,l.jsx)("p",{className:"form-text small text-muted",children:"You can use HTML tags for formatting"})]})]})]})}),(0,l.jsx)("div",{className:"card shadow-sm mb-4",children:(0,l.jsxs)("div",{className:"card-body p-4",children:[(0,l.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Featured Image"}),(0,l.jsxs)("div",{className:"row g-3",children:[(0,l.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Blog Image"}),(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>N(e,"image"),required:!r||!u.image,className:"form-control"}),r&&u.image&&(0,l.jsx)("p",{className:"form-text small text-muted mt-1",children:"Current image is uploaded. Leave empty to keep existing image."}),u.image&&(0,l.jsx)("div",{className:"mt-2",children:(0,l.jsx)("img",{src:u.image,alt:"Blog Image Preview",className:"rounded",style:{height:"10rem",width:"15rem",objectFit:"cover"}})})]}),(0,l.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,l.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Alt Text"}),(0,l.jsx)("input",{type:"text",name:"altText",value:u.altText,onChange:b,required:!0,className:"form-control"})]})]})]})}),(0,l.jsx)("div",{className:"card shadow-sm mb-4",children:(0,l.jsxs)("div",{className:"card-body p-4",children:[(0,l.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Tags"}),(0,l.jsx)("div",{className:"row g-3",children:(0,l.jsxs)("div",{className:"col-12",children:[u.tags.length>0&&(0,l.jsx)("div",{className:"mb-3",children:(0,l.jsx)("div",{className:"d-flex flex-wrap gap-2",children:u.tags.map((e,a)=>(0,l.jsxs)("span",{className:"badge bg-primary d-inline-flex align-items-center gap-1",style:{fontSize:"0.875rem"},children:[e,(0,l.jsx)("button",{type:"button",onClick:()=>{x(l=>({...l,tags:l.tags.filter(l=>l!==e)}))},className:"btn btn-sm p-0 ms-1",style:{fontSize:"0.6rem",background:"none",border:"none",color:"white",lineHeight:"1"},"aria-label":`Remove ${e} tag`,children:"×"})]},a))})}),(0,l.jsx)("div",{className:"input-group",children:(0,l.jsx)("input",{type:"text",value:g,onChange:e=>{p(e.target.value)},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),f()):","===e.key&&(e.preventDefault(),f())},className:"form-control",placeholder:"Type a tag and press Enter or comma to add"})}),(0,l.jsx)("p",{className:"form-text small text-muted",children:"Type a tag and press Enter or comma to add it. Click the × on a tag to remove it."})]})})]})}),(0,l.jsxs)("div",{className:"d-flex justify-content-end gap-3",children:[(0,l.jsx)("button",{type:"button",onClick:()=>o.back(),className:"btn btn-outline-secondary px-4 py-2",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",disabled:n,className:"btn btn-primary px-4 py-2",children:n?r?"Updating...":"Creating...":r?"Update Blog":"Create Blog"})]})]})]})}e.s(["default",()=>s])}]);