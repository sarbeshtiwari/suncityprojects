(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,47862,e=>{"use strict";var a=e.i(43476),l=e.i(71645),t=e.i(18566);function s({initialData:e,isEditMode:i=!1,eventSlug:r}={}){let n=(0,t.useRouter)(),[c,m]=(0,l.useState)(!1),[d,o]=(0,l.useState)(new Set),[h,u]=(0,l.useState)({title:e?.title||"",slug:e?.slug||"",description:e?.description||"",galleryImages:e?.galleryImages||[],metaTitle:e?.metaTitle||"",metaDescription:e?.metaDescription||"",metaKeywords:e?.metaKeywords||"",otherMetaTags:e?.otherMetaTags||"",schemaScript:e?.schemaScript||"",isActive:e?.isActive===void 0||e.isActive,isPublished:e?.isPublished===void 0||e.isPublished}),x=e=>{let{name:a,value:l,type:t}=e.target;u(s=>{let i={...s,[a]:"checkbox"===t?e.target.checked:l};return"title"===a&&l&&(i.slug=l.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()),i})},b=async(e,a)=>{let l=`${a}-${Date.now()}`;o(e=>new Set(e).add(l));try{let a=new FormData;a.append("file",e);let l=await fetch("/api/upload",{method:"POST",body:a});if(l.ok)return(await l.json()).url;throw Error("Upload failed")}catch(e){return console.error("Upload error:",e),alert("Failed to upload file"),null}finally{o(e=>{let a=new Set(e);return a.delete(l),a})}},g=async(e,a,l)=>{let t=e.target.files?.[0];if(!t)return;let s=await b(t,`gallery-${a}-${l}`);s&&u(e=>({...e,galleryImages:e.galleryImages.map((e,t)=>t===a?{...e,[l]:s}:e)}))},p=async e=>{e.preventDefault(),m(!0);try{let e=["title","slug","description"].filter(e=>!h[e]);if(e.length>0){alert(`Please fill in all required fields: ${e.join(", ")}`),m(!1);return}if(!h.galleryImages.some(e=>e.thumbnail&&e.original)){alert("Please add at least one gallery image with both thumbnail and original"),m(!1);return}let a=i?`/api/events/${r}`:"/api/events",l=i?"PUT":"POST",t=await fetch(a,{method:l,headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("adminToken")}`},body:JSON.stringify(h)}),s=await t.json();if(s.success)alert(i?"Event updated successfully!":"Event created successfully!"),n.push("/admin/events");else{let e=s.details?`${s.error}: ${Array.isArray(s.details)?s.details.join(", "):s.details}`:s.error;alert(`Failed to ${i?"update":"create"} event: `+e)}}catch(e){console.error(`Error ${i?"updating":"creating"} event:`,e),alert(`Error ${i?"updating":"creating"} event: `+(e instanceof Error?e.message:"Unknown error"))}finally{m(!1)}};return(0,a.jsxs)("div",{className:"w-100",children:[(0,a.jsxs)("div",{className:"d-flex align-items-center justify-content-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"h2 fw-bold text-dark mb-1",children:i?"Edit Event":"Add New Event"}),(0,a.jsx)("p",{className:"text-muted mb-0",children:i?"Update the event details":"Create a new event with gallery images"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>n.back(),className:"btn btn-outline-secondary d-inline-flex align-items-center px-3 py-2",children:"â† Back to Events"})]}),(0,a.jsxs)("form",{onSubmit:p,className:"w-100",children:[(0,a.jsx)("div",{className:"card shadow-sm mb-4",children:(0,a.jsxs)("div",{className:"card-body p-4",children:[(0,a.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"SEO Details"}),(0,a.jsxs)("div",{className:"row g-3",children:[(0,a.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,a.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Title"}),(0,a.jsx)("input",{type:"text",name:"metaTitle",value:h.metaTitle,onChange:x,className:"form-control"})]}),(0,a.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,a.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Keywords"}),(0,a.jsx)("input",{type:"text",name:"metaKeywords",value:h.metaKeywords,onChange:x,className:"form-control"})]}),(0,a.jsxs)("div",{className:"col-12",children:[(0,a.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Meta Description"}),(0,a.jsx)("textarea",{name:"metaDescription",value:h.metaDescription,onChange:x,className:"form-control",rows:3})]})]})]})}),(0,a.jsx)("div",{className:"card shadow-sm mb-4",children:(0,a.jsxs)("div",{className:"card-body p-4",children:[(0,a.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Event Information"}),(0,a.jsxs)("div",{className:"row g-3",children:[(0,a.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,a.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Event Title"}),(0,a.jsx)("input",{type:"text",name:"title",value:h.title,onChange:x,required:!0,className:"form-control"})]}),(0,a.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,a.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Slug (URL-friendly name)"}),(0,a.jsx)("input",{type:"text",name:"slug",value:h.slug,onChange:x,placeholder:"Will be auto-generated from title",className:"form-control"})]}),(0,a.jsxs)("div",{className:"col-12",children:[(0,a.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Event Description"}),(0,a.jsx)("textarea",{name:"description",value:h.description,onChange:x,required:!0,rows:5,className:"form-control"})]})]})]})}),(0,a.jsx)("div",{className:"card shadow-sm mb-4",children:(0,a.jsxs)("div",{className:"card-body p-4",children:[(0,a.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Gallery Images"}),(0,a.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,a.jsx)("h3",{className:"h6 fw-medium text-dark mb-0",children:"Event Gallery"}),(0,a.jsx)("button",{type:"button",onClick:()=>{u(e=>({...e,galleryImages:[...e.galleryImages,{original:"",thumbnail:"",altText:""}]}))},className:"btn btn-primary btn-sm",children:"Add Image"})]}),h.galleryImages.map((e,l)=>(0,a.jsxs)("div",{className:"border rounded p-3 mb-3",children:[(0,a.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,a.jsxs)("h4",{className:"fw-medium text-dark mb-0",children:["Image ",l+1]}),(0,a.jsx)("button",{type:"button",onClick:()=>{u(e=>({...e,galleryImages:e.galleryImages.filter((e,a)=>a!==l)}))},className:"btn btn-sm btn-outline-danger",children:"Remove"})]}),(0,a.jsxs)("div",{className:"row g-3",children:[(0,a.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,a.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Thumbnail Image"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>g(e,l,"thumbnail"),required:!i||!e.thumbnail,className:"form-control"}),i&&e.thumbnail&&(0,a.jsx)("p",{className:"form-text small text-muted mt-1",children:"Current thumbnail is uploaded. Leave empty to keep existing thumbnail."}),e.thumbnail&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("img",{src:e.thumbnail,alt:"Thumbnail Preview",className:"rounded",style:{height:"5rem",width:"8rem",objectFit:"cover"}})})]}),(0,a.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,a.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Original Image"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>g(e,l,"original"),required:!i||!e.original,className:"form-control"}),i&&e.original&&(0,a.jsx)("p",{className:"form-text small text-muted mt-1",children:"Current original image is uploaded. Leave empty to keep existing original image."}),e.original&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("img",{src:e.original,alt:"Original Preview",className:"rounded",style:{height:"5rem",width:"8rem",objectFit:"cover"}})})]}),(0,a.jsxs)("div",{className:"col-12",children:[(0,a.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Alt Text"}),(0,a.jsx)("input",{type:"text",value:e.altText,onChange:e=>{var a;return a=e.target.value,void u(e=>({...e,galleryImages:e.galleryImages.map((e,t)=>t===l?{...e,altText:a}:e)}))},className:"form-control"})]})]})]},l))]})}),(0,a.jsx)("div",{className:"card shadow-sm mb-4",children:(0,a.jsxs)("div",{className:"card-body p-4",children:[(0,a.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Status"}),(0,a.jsxs)("div",{className:"row g-3",children:[(0,a.jsx)("div",{className:"col-12 col-lg-6",children:(0,a.jsxs)("div",{className:"form-check",children:[(0,a.jsx)("input",{type:"checkbox",name:"isActive",checked:h.isActive,onChange:x,className:"form-check-input",id:"isActive"}),(0,a.jsx)("label",{className:"form-check-label",htmlFor:"isActive",children:"Active"})]})}),(0,a.jsx)("div",{className:"col-12 col-lg-6",children:(0,a.jsxs)("div",{className:"form-check",children:[(0,a.jsx)("input",{type:"checkbox",name:"isPublished",checked:h.isPublished,onChange:x,className:"form-check-input",id:"isPublished"}),(0,a.jsx)("label",{className:"form-check-label",htmlFor:"isPublished",children:"Published"})]})})]})]})}),(0,a.jsxs)("div",{className:"d-flex justify-content-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>n.back(),className:"btn btn-outline-secondary px-4 py-2",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"btn btn-primary px-4 py-2",children:c?i?"Updating...":"Creating...":i?"Update Event":"Create Event"})]})]})]})}e.s(["default",()=>s])},62660,e=>{"use strict";var a=e.i(43476),l=e.i(71645),t=e.i(18566),s=e.i(47862);function i(){(0,t.useRouter)();let e=(0,t.useParams)(),[i,r]=(0,l.useState)(null),[n,c]=(0,l.useState)(!0),[m,d]=(0,l.useState)("");(0,l.useEffect)(()=>{e.slug&&o(e.slug)},[e.slug]);let o=async e=>{try{let a=await fetch(`/api/events/${e}`),l=await a.json();l.success?r(l.data):d("Failed to fetch event")}catch(e){d("Error fetching event")}finally{c(!1)}};return n?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent"})}):m?(0,a.jsx)("div",{className:"alert alert-danger",role:"alert",children:m}):i?(0,a.jsx)(s.default,{initialData:i,isEditMode:!0,eventSlug:e.slug}):(0,a.jsx)("div",{className:"alert alert-warning",role:"alert",children:"Event not found"})}e.s(["default",()=>i])}]);