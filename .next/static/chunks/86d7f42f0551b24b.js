(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,50730,e=>{"use strict";var a=e.i(43476),t=e.i(71645),i=e.i(18566);function s(){let e=(0,i.useRouter)(),s=(0,i.useParams)().id,[r,n]=(0,t.useState)(!1),[l,m]=(0,t.useState)(!1),[o,d]=(0,t.useState)(!0),[c,u]=(0,t.useState)({image:"",caption:""});(0,t.useEffect)(()=>{(async()=>{try{let a=await fetch(`/api/amenities/${s}`),t=await a.json();t.success?u({image:t.data.image,caption:t.data.caption}):(alert("Failed to fetch amenity data"),e.push("/admin/amenities"))}catch(a){console.error("Error fetching amenity:",a),alert("Error fetching amenity data"),e.push("/admin/amenities")}finally{d(!1)}})()},[s,e]);let p=async e=>{m(!0);try{let a=new FormData;a.append("file",e),a.append("folder","amenities");let t=await fetch("/api/upload",{method:"POST",body:a});if(t.ok)return(await t.json()).url;throw Error("Upload failed")}catch(e){return console.error("Upload error:",e),alert("Failed to upload file: "+(e instanceof Error?e.message:"Unknown error")),null}finally{m(!1)}},f=async e=>{let a=e.target.files?.[0];if(!a)return;let t=a.name.toLowerCase().substring(a.name.lastIndexOf("."));if(!(["image/svg+xml","image/webp","image/avif"].includes(a.type)||[".svg",".webp",".avif"].includes(t))){alert("Please select a valid image file (SVG, WebP, or AVIF format only)"),e.target.value="";return}u(e=>({...e,image:"uploading..."}));let i=await p(a);i?u(e=>({...e,image:i})):u(e=>({...e,image:""}))},g=async a=>{if(a.preventDefault(),!c.image)return void alert("Please upload an image before submitting");n(!0);try{let a=await fetch(`/api/amenities/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("adminToken")}`},body:JSON.stringify(c)}),t=await a.json();if(t.success)e.push("/admin/amenities");else{let e=t.details?`${t.error}: ${t.details}`:t.error;alert("Failed to update amenity: "+e)}}catch(e){console.error("Submit error:",e),alert("Error updating amenity: "+(e instanceof Error?e.message:"Unknown error"))}finally{n(!1)}};return o?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent"})}):(0,a.jsxs)("div",{className:"w-100",children:[(0,a.jsxs)("div",{className:"d-flex align-items-center justify-content-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"h2 fw-bold text-dark mb-1",children:"Edit Amenity"}),(0,a.jsx)("p",{className:"text-muted mb-0",children:"Update amenity information"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>e.back(),className:"btn btn-outline-secondary d-inline-flex align-items-center px-3 py-2",children:"â† Back to Amenities"})]}),(0,a.jsxs)("form",{onSubmit:g,className:"w-100",children:[(0,a.jsx)("div",{className:"card shadow-sm mb-4",children:(0,a.jsxs)("div",{className:"card-body p-4",children:[(0,a.jsx)("h2",{className:"h5 fw-semibold text-dark mb-4 border-bottom pb-2",children:"Amenity Information"}),(0,a.jsxs)("div",{className:"row g-3",children:[(0,a.jsxs)("div",{className:"col-lg-6",children:[(0,a.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Amenity Image"}),(0,a.jsx)("input",{type:"file",accept:".svg,.webp,.avif,image/svg+xml,image/webp,image/avif",onChange:f,disabled:l,className:"form-control"}),l&&(0,a.jsx)("div",{className:"mt-2 text-sm text-muted",children:"Uploading..."}),c.image&&"uploading..."!==c.image&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("img",{src:c.image,alt:"Amenity Preview",className:"rounded",style:{height:"5rem",width:"5rem",objectFit:"cover"}})}),(0,a.jsx)("small",{className:"mt-2 text-xs text-muted",children:"Accepted formats: SVG, WebP, AVIF"}),"uploading..."===c.image&&(0,a.jsx)("div",{className:"mt-2 text-sm text-primary",children:"Uploading file..."})]}),(0,a.jsxs)("div",{className:"col-lg-6",children:[(0,a.jsx)("label",{className:"form-label small fw-medium text-muted",children:"Caption"}),(0,a.jsx)("input",{type:"text",name:"caption",value:c.caption,onChange:e=>{let{name:a,value:t}=e.target;u(e=>({...e,[a]:t}))},required:!0,className:"form-control"})]})]})]})}),(0,a.jsxs)("div",{className:"d-flex justify-content-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>e.back(),className:"btn btn-outline-secondary px-4 py-2",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:r||l,className:"btn btn-primary px-4 py-2",children:r?"Updating...":"Update Amenity"})]})]})]})}e.s(["default",()=>s])}]);